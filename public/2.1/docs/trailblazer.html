<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

    <title>Trailblazer - Trailblazer</title>

    <script src="/vite-dev/@vite/client" type="module"></script>
    <script src="/vite-dev/entrypoints/documentation.js" crossorigin="anonymous" type="module"></script>

    <link
      href="https://fonts.googleapis.com/css?family=Raleway:200,300,400,500,600,700,800"
      rel="stylesheet"
    >
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    >
    <link
      rel="preconnect"
      href="https://R2IYF7ETH7-dsn.algolia.net" crossorigin
    >
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"
    >

    

    <link rel="icon" type="image/png" sizes="32x32" href="/vite-dev/images/favicon.ico">
  </head>
  <body>
    <div class="alert alert-primary m-0 rounded-0 text-center" role="alert">
      <span class="alert-text text-center">
        <!-- The new TRB 2.1 book series has begun - 82 pages are <a class="alert-link" href="https://leanpub.com/buildalib">waiting for you</a>! -->
        Dear Russian friends, please watch President Zelenskyy's
        <a href="https://twitter.com/PMoelleken/status/1496941845812760577">speech addressed to you</a>.
        🇺🇦 Help our brave mates in Ukraine
        <a
          href="https://actions.sumofus.org/a/give-to-ukrainians-who-need-an-urgent-lifeline"
        >
          with a donation
        </a>.
      </span>
    </div>

    <div class="lg-bg">
      <!-- Add class="session-show" if you need a header with dark background -->
      <header
        id="header"
        class="trailblazer-header documentation-navbar navbar navbar-expand-lg flex-column flex-md-row"
      >
        <h1 class="m-2">
          <a class="navbar-brand mr-0 mr-md-2" href="/2.1/index.html">Trailblazer</a>
        </h1>

        <div class="navbar-nav-scroll ml-md-auto">
          <ul class="navbar-nav documentation-nav-items">
  <li>
    <a class="nav-item nav-link active" href="/2.1/docs/trailblazer.html">
      <i class="fas fa-arrow-right"></i>
      DOCS
    </a>
  </li>

  <li>
    <a class="nav-item nav-link " href="https://dev.to/trailblazer">BLOG</a>
  </li>

  <li class="d-none d-md-block">
    <a class="nav-item nav-link " href="/2.1/about_us.html">ABOUT US</a>
  </li>

  <li>
    <a class="nav-item nav-link " href="/2.1/learn.html">LEARN</a>
  </li>

  <li class="d-none d-md-block">
    <a class="nav-item nav-link" href="/2.0/index.html">
      <i class="fas fa-arrow-right"></i>
      2.0
    </a>
  </li>

  <li>
    <a class="nav-item nav-link" href="https://trailblazer.zulipchat.com" target="_blank">
      <i class="fas fa-comments"></i>
      CHAT
    </a>
  </li>

  <!--
  
    <li>
      <div id="docsearch"></div> https://docsearch.algolia.com/docs/DocSearch-v3
    </li>
  
  -->
</ul>

        </div>
      </header>

      <main>
        <section class="documentation-main">
          <div class="container-fluid">
            <div class="row flex-xl-nowrap">
              <div class="col-md-3 col-xl-2 border-bottom order-1 sidebar-accordion sidebar-scroll">
                <form class="d-md-none d-flex align-items-center position-relative py-3 mx-n3 border-bottom">
                  <button
                    class="navbar-toggler collapsed"
                    type="button"
                    data-toggle="collapse"
                    data-target="#navBarTrailBlazer"
                    aria-controls="navBarTrailBlazer"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                  >
                    <i class="far fa-lg fa-bars"></i>
                  </button>
                </form>
                <div class="collapse d-md-block py-3 mx-n3" id="navBarTrailBlazer">
                  <div class="border-bottom">
  <div class="my-4">
    <div class="sidebar-accordion-wrapper">
  <div id="trailblazer">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/trailblazer.html">
        <button
          class=""
          data-toggle="collapse"
          data-target="#trailblazer-collapse"
          aria-expanded="true"
          aria-controls="trailblazer-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Trailblazer</span>
        </button>
      </a>
    </h2>
  </div>

  
    <div
      id="trailblazer-collapse"
      class="collapse show"
      aria-labelledby="trailblazer"
      data-parent="#accordion"
    >
      <ul class="nav vertical menu navbar-light">
        
          <li class="nav-item">
            <a class="nav-link active" href="#trailblazer-about">
              About
            </a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link " href="#trailblazer-2-1-migration">
              2.1 Migration
            </a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link " href="#trailblazer-developer">
              Developer
            </a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link " href="#trailblazer-context">
              Context
            </a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link " href="#trailblazer-option">
              Option
            </a>
          </li>
        
      </ul>
    </div>
  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="rails-integration">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/rails.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#rails-integration-collapse"
          aria-expanded="false"
          aria-controls="rails-integration-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Rails Integration</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="test">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/test.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#test-collapse"
          aria-expanded="false"
          aria-controls="test-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Test</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

  </div>
</div>

<div class="border-bottom">
  <div class="my-4">
    <div class="sidebar-accordion-wrapper">
  <div id="activity">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/activity.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#activity-collapse"
          aria-expanded="false"
          aria-controls="activity-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Activity</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="macro">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/macro.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#macro-collapse"
          aria-expanded="false"
          aria-controls="macro-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Macro</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="operation">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/operation.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#operation-collapse"
          aria-expanded="false"
          aria-controls="operation-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Operation</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="workflow">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/workflow.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#workflow-collapse"
          aria-expanded="false"
          aria-controls="workflow-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Workflow</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="endpoint">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/endpoint.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#endpoint-collapse"
          aria-expanded="false"
          aria-controls="endpoint-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Endpoint</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

  </div>
</div>

<div class="border-bottom">
  <div class="my-4">
    <div class="sidebar-accordion-wrapper">
  <div id="reform">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/reform.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#reform-collapse"
          aria-expanded="false"
          aria-controls="reform-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Reform</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="cells">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/cells.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#cells-collapse"
          aria-expanded="false"
          aria-controls="cells-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Cells</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="representable">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/representable.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#representable-collapse"
          aria-expanded="false"
          aria-controls="representable-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Representable</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="disposable">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/disposable.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#disposable-collapse"
          aria-expanded="false"
          aria-controls="disposable-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Disposable</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="roar">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/roar.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#roar-collapse"
          aria-expanded="false"
          aria-controls="roar-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Roar</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

  </div>
</div>

<div class="border-bottom">
  <div class="my-4">
    <div class="sidebar-accordion-wrapper">
  <div id="tutorials">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/tutorials/activity.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#tutorials-collapse"
          aria-expanded="false"
          aria-controls="tutorials-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Tutorials</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="pro">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/pro.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#pro-collapse"
          aria-expanded="false"
          aria-controls="pro-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>PRO</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

  </div>
</div>

                </div>
              </div>

              <main
                class="col-md-9 col-xl-8 py-md-5 pl-md-5 order-2"
                role="main"
              >
                <div class="doc-block section-name session-show">
                  <h1 class="w-100">Trailblazer</h1>
                  <ul>
                    <li>
                      <i class="far fa-clock pink"></i>
                      <span>Last updated 22 Aug 22</span>
                    </li>
                  </ul>
                </div>

                <div class="doc-block">
<p><span class="divider"></span></p>

<h2 id="trailblazer-about">About</h2>
<p><!-- {trailblazer-about-toc} --></p>

<p>The Trailblazer project started off with a single gem called <code>trailblazer</code>. Currently, the framework consists of around 40 gems. The main gem <code>trailblazer</code> is an umbrella gem with the sole reason to pull all default dependencies for you. Feel free to pick and choose what you need for your applications.</p>

<div class="bd-callout bd-callout-info">
<p>Are you new to TRB? Then it’s probably best to start on <a href="/2.1/learn.html">our LEARN page</a> and find out more about this framework!</p>
</div>

<p><span class="divider"></span></p>

<h3 id="trailblazer-about-overview">Overview</h3>
<p><!-- {trailblazer-about-overview-toc} --></p>

<p>The following list of gems is an overview of the most important core components in Trailblazer.</p>

<table class="table table-striped-gems">
  <thead>
    <tr>
      <th colspan="2">Gem</th>
      <th colspan="3">Summary</th>
      <th colspan="2">Dependencies</th>
      <th>Source</th>
    </tr>
  </thead>
  <tbody>
    <tr class="trailblazer-group">
      <td colspan="2"></td>
      <td colspan="3" class="text-center"><strong>CORE</strong></td>
      <td colspan="2"></td>
      <td></td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/trailblazer.html#trailblazer-rails">trailblazer-rails</a></nobr>
      </td>
      <td colspan="3">
        Glue code for conveniently using TRB in a Rails project. Adds <code>Controller#run</code> for invoking operations and <code>Controller#cell</code> to render cells.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-rails" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/activity.html">trailblazer-activity</a></nobr>
      </td>
      <td colspan="3">
        Callable run-time circuits that control the execution flow of your tasks.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-activity" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/activity.html#activity-overview-dsl">trailblazer-activity-dsl-linear</a></nobr>
      </td>
      <td colspan="3">
        DSL that provides <code>Path</code>, <code>Railway</code> and <code>FastTrack</code> activities.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-activity-dsl-linear"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/trailblazer.html#trailblazer-context">trailblazer-context</a></nobr>
      </td>
      <td colspan="3">
        Context implementation.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-context" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/trailblazer.html#trailblazer-option">trailblazer-option</a></nobr>
      </td>
      <td colspan="3">
        Callables implementation.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-option" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr class="trailblazer-group">
      <td colspan="2"></td>
      <td colspan="3" class="text-center"><strong>HELPER</strong></td>
      <td colspan="2"></td>
      <td></td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/endpoint.html">trailblazer-endpoint</a></nobr>
      </td>
      <td colspan="3">
        Implement the entire controller flow, from authentication until rendering, via activities.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-endpoint" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/operation.html">trailblazer-operation</a></nobr>
      </td>
      <td colspan="3">
        Thin API around <code>FastTrack</code> exposing the "old" <code>call</code>-API named <code>Operation</code>.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-operation" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/operation.html#operation-macros">trailblazer-macro</a></nobr>
      </td>
      <td colspan="3">
        Provides <code>Nested()</code>, <code>Model()</code> and other macros for everyday usage.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-macro" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/operation.html#operation-contract-validate">trailblazer-macro-contract</a></nobr>
      </td>
      <td colspan="3">
        Provides the <code>Contract::Validate()</code> macro and friends.
      </td>
      <td colspan="2">
        reform, dry-validation
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-macro-contract" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr class="trailblazer-group">
      <td colspan="2"></td>
      <td colspan="3" class="text-center"><strong>TOOLS</strong></td>
      <td colspan="2"></td>
      <td></td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/trailblazer.html#trailblazer-developer">trailblazer-developer</a></nobr>
      </td>
      <td colspan="3">
        Activity visualization, tracing, debugging, PRO Editor communication.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-developer" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/trailblazer.html#trailblazer-test">trailblazer-test</a></nobr>
      </td>
      <td colspan="3">
        Minitest assertions and tools for fast TRB testing.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/trailblazer-test" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="#">trailblazer-rspec</a></nobr>
      </td>
      <td colspan="3">
        Rspec testing extensions.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/rspec-trailblazer" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr class="trailblazer-group">
      <td colspan="2"></td>
      <td colspan="3" class="text-center"><strong>PRO</strong></td>
      <td colspan="2"></td>
      <td></td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="#">trailblazer-workflow</a></nobr>
      </td>
      <td colspan="3">
        Long-running activities with process engine, events and collaboration.
      </td>
      <td colspan="2">
      </td>
      <td></td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="#">trailblazer-activity-implementation</a></nobr>
      </td>
      <td colspan="3">
        DSL for creating activities from PRO Editor exports.
      </td>
      <td colspan="2">
      </td>
      <td></td>
    </tr>
  </tbody>
</table>

<p>Along with the core gems goes a rich list of eco-system gems.</p>

<table class="table table-striped-gems">
  <thead>
    <tr>
      <th colspan="2">Gem</th>
      <th colspan="3">Summary</th>
      <th colspan="2">Dependencies</th>
      <th>Source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/reform.html">reform</a></nobr>
      </td>
      <td colspan="3">
        Form objects.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/reform" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/cells.html">cells</a></nobr>
      </td>
      <td colspan="3">
        Generic view components.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/cells" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/representable.html">representable</a></nobr>
      </td>
      <td colspan="3">
        Maps representation documents from and to Ruby objects.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/representable" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/disposable.html">disposable</a></nobr>
      </td>
      <td colspan="3">
        Decorators on top of your ORM layer.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/apotonick/disposable" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>

    <tr>
      <td colspan="2">
        <nobr><a href="/2.1/docs/roar.html">roar</a></nobr>
      </td>
      <td colspan="3">
        Parse and render REST API documents using representers.
      </td>
      <td colspan="2">
      </td>
      <td>
        <nobr><a href="https://github.com/trailblazer/roar" target="_blank"><i class="fab fa-github"></i></a></nobr>
      </td>
    </tr>
  </tbody>
</table>

<p><span class="divider"></span></p>

<h2 id="trailblazer-2-1-migration">2.1 Migration</h2>
<p><!-- {trailblazer-2-1-migration-toc} --></p>

<p><span class="divider"></span></p>

<h3 id="trailblazer-2-1-migration-call-api">Call API</h3>
<p><!-- {trailblazer-2-1-migration-call-api-toc} --></p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Call API</li>
    <li id="trailblazer-2-1-migration-call-api-operation-call">Operation.call</li>
</ul>

<p>In versions before 2.1, the automatic merging of the params part and the additional options was confusing many new users and an unnecessary step.</p>

<pre><code># old style
result = Memo::Create.( params, "current_user" =&gt; current_user )
</code></pre>

<p>The first argument (params) was merged into the second argument using the key “params”. You now pass one hash to call and hence do the merging yourself.</p>

<pre><code># new style
result = Memo::Create.( params: params, current_user: current_user )
</code></pre>

<p>The new call API is much more consistent and takes away another thing we kept explaining to new users - an indicator for a flawed API.</p>

<div class="bd-callout bd-callout-info">
<p>For a soft deprecation, do this in an initializer:</p>

<pre><code>require "trailblazer/deprecation/call"
</code></pre>

<p>You will get a bunch of warnings, so fix all <code>Operation.()</code> calls and remove the require again. This is provied by <a href="https://github.com/trailblazer/trailblazer-future">trailblazer-future</a> gem.</p>
</div>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Call API</li>
    <li id="trailblazer-2-1-migration-call-api-step-signature">Step Signature</li>
</ul>

<p>In case your steps expose a signature as follows, you’re safe.</p>

<pre><code>class Memo::Create &lt; Trailblazer::Operation
  step :create_model

  def create_model(options, params:, **)
    # ..
  end
end
</code></pre>

<p>By convention, we renamed <code>option</code> to <code>ctx</code>, but it is completely up to you to adopt this.</p>

<p>Nevertheless, the “old style” signatures won’t work anymore.</p>

<pre><code>class Memo::Create &lt; Trailblazer::Operation
  def create_model(options)
    # ..
  end

  # or

  def create_model(model:, **)
    # ..
  end
end
</code></pre>

<p>Neither a single <code>options</code> nor keyword-arguments-only are gonna fly as the new step signature is more restrictive and always requires you to maintain the <code>ctx</code> (or <code>options</code>, if you will) as the first positional argument, then keyword arguments.</p>

<p>Double splat operator <code>**</code> at the end will be required to in order to discard unused kw args.</p>

<div class="bd-callout bd-callout-info">
<p>You can introduce this change before actual migration to 2.1.</p>
</div>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Call API</li>
    <li id="trailblazer-2-1-migration-call-api-pass-fail">pass/fail</li>
</ul>

<p>Steps declared as <code>success</code> or <code>failure</code> are now renamed to <code>pass</code> and <code>fail</code> respectively.</p>

<pre><code>class Memo::Create &lt; Trailblazer::Operation
  success :model
  failure :handle_some_error
end
</code></pre>

<p>Change it as follows.</p>

<pre><code>class Memo::Create &lt; Trailblazer::Operation
  pass :model
  fail :handle_some_error
end
</code></pre>

<p>If you are using Rubocop it will probably start complaining about unreachable code because it just so happens that <code>fail</code> is also a Ruby Kernel’s <a href="https://ruby-doc.org/core-2.0.0/Kernel.html#method-i-fail">method</a>. One solution to this could be to add a custom rule to <code>.rubocop.yml</code> like this:</p>

<pre><code>Lint/UnreachableCode:
  Exclude:
    - '*/**/concepts/**/operation/**/*'
Style/SignalException:
  Exclude:
    - '*/**/concepts/**/operation/**/*'
</code></pre>

<p>There is also a <code>trick</code> that will allow you to do this rename before actually migrating to 2.1. You can put this in an initializer:</p>

<pre><code>Trailblazer::Operation::Pipetree::DSL.send(:alias_method, :pass, :success)
Trailblazer::Operation::Pipetree::DSL.send(:alias_method, :fail, :failure)
</code></pre>

<p>This way you could introduce this change before actual migration to 2.1. Just don’t forget to remove it after updating gems to 2.1.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Call API</li>
    <li id="trailblazer-2-1-migration-call-api-pass_fast-fail_fail">pass_fast/fail_fail</li>
</ul>

<p>Now every step that may end up in <code>pass_fast</code> or <code>fail_fast</code> signals need an extra option that indicates fast track usage. Change this operation:</p>

<pre><code>class Memo::Create &lt; Trailblazer::Operation
  step :create

  def create(ctx, **)
    Railway.pass_fast! if ctx[:model].save
  end
end
</code></pre>

<p>Use the <code>:fast_track</code> option to let Trailblazer know about the potential new signal being emitted.</p>

<pre><code>class Memo::Create &lt; Trailblazer::Operation
  step :create, fast_track: true # notice the extra option :fast_track

  def create(ctx, **)
    Railway.pass_fast! if ctx[:model].save
  end
end
</code></pre>

<p><span class="divider"></span></p>

<h3 id="trailblazer-2-1-migration-context">Context</h3>
<p><!-- {trailblazer-2-1-migration-context-toc} --></p>

<p>The keys for <code>ctx</code> used to be mixed up, some where <code>"longer.strings"</code>, some were <code>:symbols</code>. The new context implementation <code>Context::IndifferentAccess</code> now allows to use both.</p>

<pre><code>ctx["model"]
ctx[:model]  # =&gt; same!
</code></pre>

<p>This also works for namespaced keys, which you still might find helpful.</p>

<pre><code>ctx["contract.default"]
ctx[:"contract.default"]  # =&gt; same!
</code></pre>

<div class="bd-callout bd-callout-info">
<p>On the core level, we use symbol keys, only (e.g. <code>:"contract.default"</code>).</p>
</div>

<p>The default implementation of the context object can be set by overriding <code>Context.implementation</code>. For example, if you want the old behavior back.</p>

<pre><code>class Trailblazer::Context
  def self.implementation
    Context # old behavior.
  end
end
</code></pre>

<p>Note that the override might be deprecated in favor of a dependency injection.</p>

<p><span class="divider"></span></p>

<h3 id="trailblazer-2-1-migration-nested">Nested</h3>
<p><!-- {trailblazer-2-1-migration-nested-toc} --></p>

<p>The <code>Nested</code> macro allows to, well, nest activities or operations, providing a neat way to encapsulate and reuse logic.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Nested</li>
    <li id="trailblazer-2-1-migration-nested-deprecation">Deprecation</li>
</ul>

<p>In 2.1, the [<code>Subprocess</code> macro] is the standard way for nesting. The <code>Nested</code> macro should only be used when you use the dynamic version where the nested operation is computed at runtime using <code>:builder</code>.</p>

<p>An exception will warn you about the inappropriate usage.</p>

<pre><code>[Trailblazer] Using the `Nested()` macro with operations and activities is deprecated. Replace `Nested(Create)` with `Subprocess(Create)`.
</code></pre>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Nested</li>
    <li id="trailblazer-2-1-migration-nested-input-and-output">input and output</li>
</ul>

<p>Both the <code>:input</code> and <code>:output</code> options that used to go with <code>Nested(Present, :input: ...)</code> are now a generic option in Trailblazer. Move them behind the
macro parenthesis.</p>

<pre><code># 2.0
Nested(Present, input: :my_input, output: :my_output)

# 2.1
Nested(Present), input: :my_input, output: :my_output
</code></pre>

<p>An exception will stop compilation if you fail to obey.</p>

<pre><code>ArgumentError: unknown keyword: input
</code></pre>

<p>Behold of another tiny API change! The <code>:output</code> filter signature has changed for a better.</p>

<p>In Trailblazer 2.0, the following signature was allowed.</p>

<pre><code># 2.0
Nested(Present,
  output: -&gt;(ctx, mutable_data:, **) {
    {model: mutable_data[:article]} # you used the {mutable_data} keyword argument.
  }
)
</code></pre>

<p>Mind the arguments being passed to <code>:output</code>. The first positional is the original outer context, the context from the nested operation comes as a <code>mutable_data:</code> keyword argument.</p>

<p>In 2.1, those two have swapped.</p>

<pre><code># 2.1
Nested(Present),
  output: -&gt;(inner_ctx, article:, **) {
    # {inner_ctx} is {mutable_data}
    {model: article} # you used the {mutable_data} keyword argument.
  }
</code></pre>

<p>The inner context from the nested operation comes first, as a positional argument. Note how you can conveniently use keyword arguments to access variables from this inner ctx (e.g. <code>article:</code>). Keep in mind, the naming is completely up to you. We use <code>inner_ctx</code>/<code>ctx</code> and <code>original_ctx</code> in our code.</p>

<p>If you also need the original context in the <code>:output</code> filter, use the <code>:output_with_outer_ctx</code> option.</p>

<pre><code># 2.1
Nested(Present),
  output_with_outer_ctx: true
  output: -&gt;(inner_ctx, original_ctx, article:, **) {
    {
      model:  article,
      errors: original_ctx[:errors].merge(inner_ctx[:errors]) # you can access the outer ctx!
    }
  }
</code></pre>

<p>The original, outer ctx comes in as a second positional argument.</p>

<div class="bd-callout bd-callout-info">
<p>You do not need to <code>extend Uber::Callable</code> in classes with <code>#call</code> methods anymore.</p>
</div>

<p>Check the <a href="/2.1/docs/activity.html#activity-variable-mapping">Variable Mapping docs</a> for a complete explanation.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Nested</li>
    <li id="trailblazer-2-1-migration-nested-fast-track">Fast Track</li>
</ul>

<p>Don’t forget to declare fast track usage if you expect it from within nested operation, like this:</p>

<pre><code>Nested(Present), input: :my_input, output: :my_output, fast_track: true
</code></pre>

<p>Another difference is that in 2.0, when you were using <code>pass_fast</code> in nested operations, it would stop only the nested operation from executing. After this the outer one would continue executing.</p>

<p>Now returning <code>pass_fast</code> in nested operation will stop both, inner and outer operation with <code>success</code> as a final result. If you rely on old behaviour you can still have it with proper signals mapping:</p>

<pre><code>Nested(Present), input: :my_input,
                 output: :my_output,
                 fast_track: true,
                 Output(:pass_fast) =&gt; Track(:success), # pass_fast now mapped to `just` a success
                 Output(:fail_fast) =&gt; End(:failure)
</code></pre>

<p><span class="divider"></span></p>

<h3 id="trailblazer-2-1-migration-macro-api">Macro API</h3>
<p><!-- {trailblazer-2-1-migration-macro-api-toc} --></p>

<p>Macros are functions that add a task along with specific options to the activity. In TRB 2.0, those (historically camel-cased) functions returned an array with two elements.</p>

<pre><code>module MyMacro
  def self.NormalizeParams(name: :myparams, merge_hash: {})
    task = -&gt;((ctx, flow_options), _) do
      ctx[name] = ctx[:params].merge(merge_hash)

      return Trailblazer::Activity::Right, [ctx, flow_options]
    end

    [task, name: name] # old API
  end
end
</code></pre>

<p>In 2.1, a hash is returned. Note that <code>:name</code> is <code>:id</code> now.</p>

<pre><code>module MyMacro
  def self.NormalizeParams(name: :myparams, merge_hash: {})
    task = -&gt;((ctx, flow_options), _) do
      ctx[name] = ctx[:params].merge(merge_hash)

      return Trailblazer::Activity::Right, [ctx, flow_options]
    end

    # new API
    {
      task: task,
      id:   name
    }
  end
end
</code></pre>

<p>This allows for a much richer macro experience where you might add additional steps via a macro, use DSL options such as <code>:before</code> and <code>:after</code> and add taskWrap extensions. [macro API]</p>

<p>A common error if you don’t return a hash from your macro is a <code>call</code> on <code>Array</code>.</p>

<pre><code>NoMethodError:
   undefined method `call' for #&lt;Array:0x000055663116be98&gt;
 # gems/trailblazer-context-0.4.0/lib/trailblazer/option.rb:9:in `call!'
</code></pre>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Macro API</li>
    <li id="trailblazer-2-1-migration-macro-api-signature-and-return">Signature and Return</li>
</ul>

<p>In Trailblazer 2.0, macros were automatically using the task interface. Mind the arguments and the return value.</p>

<pre><code>task = -&gt;(ctx, current_user:, model:, **) {
  # do something
  # return true/false
}
</code></pre>

<p>In Trailblazer 2.1, macros use the <a href="/2.1/docs/activity.html#activity-internals-circuit-interface">circuit interface</a> per default. If you want the simpler task interface, you need to wrap your task using <code>Binary()</code>.</p>

<pre><code>def MyMacro()
  task = -&gt;(ctx, current_user:, model:, **) {
    # do something
    # return true/false
  }

  {
    task: Trailblazer::Activity::TaskBuilder.Binary(task), # wrap the callable.
    id: "my_macro"
  }
</code></pre>

<p>A common error if you don’t wrap your macro is an <code>ArgumentError</code>.</p>

<pre><code>ArgumentError:
       missing keywords: current_user, model
</code></pre>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Macro API</li>
    <li id="trailblazer-2-1-migration-macro-api-step-id">Step id</li>
</ul>

<p>In case you used the same macro twice in one operation, like this for example:</p>

<pre><code>class Create &lt; Trailblazer::Operation
  step Contract::Persist(method: :sync)
  step Contract::Persist(method: :save!)
end
</code></pre>

<p>You will have to specify id explictly for one of them:</p>

<pre><code>class Create &lt; Trailblazer::Operation
  step Contract::Persist(method: :sync)
  step Contract::Persist(method: :save!), id: "some_custom_unique_id"
end
</code></pre>

<p><span class="divider"></span></p>

<h3 id="trailblazer-2-1-migration-contract-dsl">Contract DSL</h3>
<p><!-- {trailblazer-2-1-migration-contract-dsl-toc} --></p>

<p>It was possible to define contracts on the operation level using a DSL.</p>

<pre><code>class Create &lt; Trailblazer::Operation
  contract do
    property :id
  end

  step Contract::Build()
  step Contract::Validate()
end
</code></pre>

<p>Since the usability doesn’t outweigh the complexity needed to implement such DSL, we decided to remove that functionality <em>for now</em>.</p>

<p>Instead, use an explicit inline class and the <code>:constant</code> option.</p>

<pre><code>class Create &lt; Trailblazer::Operation
  class Form &lt; Reform::Form
    property :id
  end

  step Contract::Build(constant: Form)
  step Contract::Validate()
end
</code></pre>

<p><span class="divider"></span></p>

<h3 id="trailblazer-2-1-migration-trailblazer-loader">Trailblazer loader</h3>
<p><!-- {trailblazer-2-1-migration-trailblazer-loader-toc} --></p>

<p>Usage of a <a href="https://github.com/trailblazer/trailblazer-loader">trailblazer-loader</a> is now discouraged as it’s slower than the ones provided by Rails and it’s error prone.</p>

<p>In short, we decided to adopt the Rails naming scheme and change operation names from <code>User::Create</code> to <code>User::Operation::Create</code>, so the file name and class path are in sync.</p>

<p>Read the <a href="trailblazer.html#trailblazer-rails-loader-loader-with-rails">details here</a>.</p>

<p>We highly recommend changing this with your upgrade as it highly improves the dev experience.</p>

<p><span class="divider"></span></p>

<h2 id="trailblazer-developer">Developer</h2>
<p><!-- {trailblazer-developer-toc} --></p>

<p><a href="https://github.com/trailblazer/trailblazer-developer" class="pink"><i class="fa fa-gem" aria-hidden="true"></i> trailblazer-developer 0.1.0</a></p>

<p>Trailblazer provides a rich set of developer tools to ease debugging and make modelling processes a pleasant experience.</p>

<p>The <a href="https://github.com/trailblazer/trailblazer-developer"><code>developer</code> gem</a> contains tools to help you visualize and debug Trailblazer code. Its development features such as tracing or exception handling are advanced tools and will become your best friends very quickly.</p>

<p><span class="divider"></span></p>

<h3 id="trailblazer-developer-constant">Constant</h3>
<p><!-- {trailblazer-developer-constant-toc} --></p>

<p>We advise you to alias the <code>Developer</code> constant to something handy, such as <code>::Dev</code> in your project. For instance, in Rails you’d have the following line in a <code>config/initializers/trailblazer.rb</code> initializer.</p>

<pre><code># config/initializers/trailblazer.rb
require "trailblazer/developer"
Dev = Trailblazer::Developer
</code></pre>

<p><span class="divider"></span></p>

<h3 id="trailblazer-developer-wtf-">Wtf?</h3>
<p><!-- {trailblazer-developer-wtf--toc} --></p>

<p>The iconic <code>wtf?</code> method is one way to invoke an operation with tracing turned on. During the execution, invoked steps are traced and printed in the console as a tree-view, helping you to understand the code path the operation took. It is one of Trailblazer’s most-loved features and was introduced in Trailblazer 2.1.</p>

<p>When working with a <code>Trailblazer::Operation</code> simply invoke its <code>#wtf?</code> method.</p>

<pre><code>result = Memo::Operation::Create.wtf?(params: {title: "Remember me..."})
</code></pre>

<p>On the console, you can see the printed trace in all its beauty.</p>

<p><img class="mx-auto d-block" src="/vite-dev/images/wtf-trace-nice.png" /></p>

<p>This method is especially helpful if you want to</p>

<ul>
  <li>Debug an exception happening somewhere deep in your code.</li>
  <li>Find out which step changed the track to failure.</li>
  <li>Focus on specific step(s) to find out what <code>ctx</code> mutations are happening inside them.</li>
</ul>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Wtf?</li>
    <li id="trailblazer-developer-wtf-exception">Exception</li>
</ul>

<p>In case of an exception somewhere in the operation or its nested activities, <code>wtf?</code> will print the trace path to the closest point where the exception was thrown.</p>

<p><img class="mx-auto d-block" src="/vite-dev/images/wtf-exception.png" /></p>

<p>The original exception will be visible on the console, too.</p>

<div class="bd-callout bd-callout-info">
<p>Please note that this is a higher-level debugging tool that does not confront you with a 200-lines stack trace the way Ruby does it, but pinpoints the exceptional code and locates the problem on a task level.</p>

<p>This is possible due to you structuring code into higher abstractions, tasks and activities.</p>
</div>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Wtf?</li>
    <li id="trailblazer-developer-wtf-activity">Activity</li>
</ul>

<p>The <code>#wtf?</code> class method is only available for <code>Trailblazer::Operation</code> subclasses. You will get an exception if you try to use it with <code>Trailblazer::Activity::Railway</code> and other activities.</p>

<pre><code>NoMethodError: undefined method `wtf?' for Memo::Operation::Create:Class
</code></pre>

<p>However, tracing can be used with low-level <code>Activity</code> classes, too.</p>

<pre><code>module Memo::Operation
  class Create &lt; Trailblazer::Activity::Railway # Note that this is not an {Operation}!
    step :extract_markdown
    step :model
    # ...
  end
end
</code></pre>

<p>You have to use the clumsier <code>Developer.wtf?</code> method for tracing.</p>

<pre><code>signal, (ctx, _) = Trailblazer::Developer.wtf?(
  Memo::Operation::Create, [{params: {title: "Remember me.."}}, {}]
)
</code></pre>

<p>As always with <code>Activity</code> subclasses, it operates with the <a href="activity.html#activity-internals-circuit-interface">circuit interface</a>.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Wtf?</li>
    <li id="trailblazer-developer-wtf-color_map">color_map</li>
</ul>

<p>The <code>color_map</code> option allows you to customize default coloring scheme being used to render passed or failed steps.</p>

<p><img class="mx-auto d-block" src="/vite-dev/images/wtf-color-map.webp" /></p>

<p><span class="divider"></span></p>

<h3 id="trailblazer-developer-render">Render</h3>
<p><!-- {trailblazer-developer-render-toc} --></p>

<p>It often is helpful to visualize an activity. One way is the <code>render</code> helper.</p>

<pre><code>puts Trailblazer::Developer.render(Memo::Create)
</code></pre>

<p>The rendered output prints each task, its outputs and where they’re connected to.</p>

<div class="bd-callout bd-callout-info">
<p>We’re working on improved visualization for the console, and for the web editor. If you want to help, please ping us on <a href="https://trailblazer.zulipchat.com/">our chat</a>.</p>
</div>

<p><span class="divider"></span></p>

<h3 id="trailblazer-developer-render-linear">Render Linear</h3>
<p><!-- {trailblazer-developer-render-linear-toc} --></p>

<p><span class="divider"></span></p>

<h3 id="trailblazer-developer-client">Client</h3>
<p><!-- {trailblazer-developer-client-toc} --></p>

<p>The <code>Developer::Client</code> module provides functions to work with activities and workflows created in the PRO editor.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Client</li>
    <li id="trailblazer-developer-client-import">Import</li>
</ul>

<p>Notes</p>

<ul>
  <li>IDs are extracted from the label of the element. They get <code>chomp</code>ed to remove a potential newline at the end and reduce confusion.</li>
  <li>It is currently not possible to assign semantics to arrows via the label. In the meantime, use the <code>:query</code> option. # TODO</li>
</ul>

<p><span class="divider"></span></p>

<h2 id="trailblazer-context">Context</h2>
<p><!-- {trailblazer-context-toc} --></p>

<p>Context aka <code>ctx</code> (or plain old <code>options</code>) is a core argument-specific data structure for Trailblazer. It provides a generic, ordered read/write interface that collects mutable runtime-computed data while providing access to any compile-time information. It is extracted into its own <a href="https://github.com/trailblazer/trailblazer-context">gem</a> and can also be used independently.</p>

<p><span class="divider"></span></p>

<h3 id="trailblazer-context-ctx">ctx</h3>
<p><!-- {trailblazer-context-ctx-toc} --></p>

<p><code>ctx</code> can be initialized when an operation is invoked at the run time or by defining <a href="/2.1/docs/operation.html#operation-options-class-dependencies">dependencies</a> at the compile time. Inside the operation, it gets passed down to every <code>step</code> with it’s argument position depending on step’s <a href="/2.1/docs/activity.html#activity-internals-circuit-interface">interface</a>. It will contain whatever the most recently executed step has changed and hopefully contains what you’re expecting.</p>

<div class="bd-callout bd-callout-info">
<p>If you want to see what <code>ctx</code> modifications are being performed per step or at specific steps, you can debug it using developer’s <a href="/2.1/docs/trailblazer.html#trailblazer-developer-wtf-focus_on">focus_on</a> API.</p>
</div>

<p><code>ctx</code>’s purpose is to hold the state of your activity which can also be passed down to other nested activities using <a href="/2.1/docs/activity.html#activity-wiring-api-subprocess">Subprocess</a>. You can filter what such activities can or can not “see” using <a href="/2.1/docs/activity.html#activity-variable-mapping">variable mapping</a>. After operation’s execution using public call, the <a href="/2.1/docs/operation.html#operation-overview-result">Result</a> object wraps the context for convenient access.</p>

<p>In order to provide the generic interface, scoping and debugging capabilities, the “Hash” argument you provide to an operation is initialized as an instance of <code>Trailblazer::Context::Container</code> to build up the final <code>ctx</code>. This allows us to support more features on top of it like indifferent access, aliasing etc</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>ctx</li>
    <li id="trailblazer-context-ctx-indifferent-access">Indifferent Access</li>
</ul>

<p><code>ctx</code> mimics as “Hash” and also allows you to use Strings or Symbols interchangeably as keys; similar to the <code>params</code> hash in Rails.</p>

<pre><code>result = Memo::Create.(params: { text: "Enjoy an IPA" })

result[:params]     # =&gt; { text: "Enjoy an IPA" }
result['params']    # =&gt; { text: "Enjoy an IPA" }
</code></pre>

<p>All keys are stored as Symbols by default in order to allow them to be accessible as keyword arguments.
Note that <code>ctx</code> doesn’t provide interchangeable keys for any nested hashes because of the performance reasons.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>ctx</li>
    <li id="trailblazer-context-ctx-aliases">Aliases</li>
</ul>

<p>Most commonly found keys in <code>ctx</code> are <code>'contract.default', 'contract.default.params', 'policy.default'</code> etc. It sometimes becomes cumbersome to access them from <code>ctx</code> as they can’t be defined as keyword arguments in steps.</p>

<p>To overcome this, it is possible to define a shorter versions of context keys using <code>aliases</code>. By providing aliases mapping in <code>flow_options[:context_options]</code>, context will maintain any mutations being made on the origianl keys with 
the aliases and vice versa.</p>

<pre><code>options = { params: { text: "Enjoy an IPA" } }
flow_options = {
  context_options: {
    aliases: { 'contract.default': :contract, 'policy.default': :policy },
    container_class: Trailblazer::Context::Container::WithAliases,
  }
}

# Sorry, this feature is only reliable in Ruby &gt; 2.7
if Gem::Version.new(RUBY_VERSION) &gt;= Gem::Version.new("3.0.0")
  result = AliasesExample::Memo::Create.(options, flow_options)
else # Ruby 2.6 etc
  result = AliasesExample::Memo::Create.call_with_flow_options(options, flow_options)
end

result['contract.default']  # =&gt; Memo::Contract::Create
result[:contract]           # =&gt; Memo::Contract::Create
</code></pre>

<p><code>flow_options</code> are passed to the nested operations via <code>Subprocess</code> and all given aliases will also be applied in them by default.</p>

<pre><code>class Memo::Create &lt; Trailblazer::Operation
  # ...

  pass :sync

  def sync(ctx, contract:, **)
    # ctx['contract.default'] == ctx[:contract]
    contract.sync
  end
end
</code></pre>

<p><span class="divider"></span></p>

<h2 id="trailblazer-option">Option</h2>
<p><!-- {trailblazer-option-toc} --></p>

<p><a href="https://github.com/trailblazer/trailblazer-option">Trailblazer::Option</a> is one of the core concept behind operation’s <a href="/2.1/docs/activity.html#activity-wiring-api">step API</a>, reform’s <a href="/2.1/docs/reform.html#reform-populators">populator API</a> etc. It makes us possible to accept any kind of callable objects at compile time and execute them at runtime.</p>

<pre><code class="language-ruby">class Song::Create &lt; Trailblazer::Operation
  step Authorize				# Module callable
  step :model					# Method callable
  step -&gt;(ctx, model:, **) { puts model }	# Proc callable
end
</code></pre>

<p>It is also a replacement over <a href="https://github.com/apotonick/declarative-option">declarative-option</a> and has been extracted out from <a href="https://github.com/trailblazer/trailblazer-context">trailblazer-context</a> by identifying common callable patterns.</p>

<p><span class="divider"></span></p>

<h3 id="trailblazer-option-callables">Callables</h3>
<p><!-- {trailblazer-option-callables-toc} --></p>

<p><code>Trailblazer::Option()</code> accepts <code>Symbol</code>, <code>lambda</code> and any other type of callable as an argument. It will be wrapped accordingly to make an executable, so you can evaluate it at runtime.</p>

<p>Passing a <code>Symbol</code> will be treated as a method that’s called on the given <code>exec_context</code>.</p>

<pre><code>option = Trailblazer::Option(:object_id)
option.(exec_context: Object.new) # =&gt; 1234567
</code></pre>

<p>Same with the objects responding to <code>.call</code> or <code>#call</code> method.</p>

<pre><code>class CallMe
  def self.call(message:, **options)
    message
  end
end

option = Trailblazer::Option(CallMe)
option.(keyword_arguments: { message: "hello!" }, exec_context: nil) # =&gt; "hello!"
</code></pre>

<div class="bd-callout bd-callout-info">
<p>Notice the usage of <code>keyword_arguments</code> while calling an <code>Option()</code>. They need to be mentioned explicitly in order for them to be <a href="https://www.ruby-lang.org/en/news/2019/12/12/separation-of-positional-and-keyword-arguments-in-ruby-3-0/">compatible</a> with ruby 2.7+.</p>
</div>

<p>And of course, passing lambdas. They get executed within given <code>exec_context</code> when set.</p>

<pre><code>option = Trailblazer::Option(-&gt; { object_id })
option.(exec_context: Object.new) # =&gt; 1234567
</code></pre>

</div>

                <aside>
                  <span class="deco-purple-cross wow fadeIn"></span>
                </aside>
              </main>

              <div class="d-none d-xl-block col-xl-2 list-group sidebar-scroll order-3">
                <img alt="Trailblazer" class="wow fadeIn" src="/vite-dev/images/deco1.webp" />
                <div class="features" id="trailblazer-about-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>About</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#trailblazer-about-overview">
          <i class="fas fa-arrow-right"></i>
          Overview
        </a>
      </li>
      
    
  </ul>
</div>

<div class="features" id="trailblazer-2-1-migration-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>2.1 Migration</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#trailblazer-2-1-migration-call-api">
          <i class="fas fa-arrow-right"></i>
          Call API
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-2-1-migration-call-api-operation-call">Operation.call</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-2-1-migration-call-api-step-signature">Step Signature</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-2-1-migration-call-api-pass-fail">pass/fail</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-2-1-migration-call-api-pass_fast-fail_fail">pass_fast/fail_fail</a>
        </li>
      
    
      <li>
        <a href="#trailblazer-2-1-migration-context">
          <i class="fas fa-arrow-right"></i>
          Context
        </a>
      </li>
      
    
      <li>
        <a href="#trailblazer-2-1-migration-nested">
          <i class="fas fa-arrow-right"></i>
          Nested
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-2-1-migration-nested-deprecation">Deprecation</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-2-1-migration-nested-input-and-output">input and output</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-2-1-migration-nested-fast-track">Fast Track</a>
        </li>
      
    
      <li>
        <a href="#trailblazer-2-1-migration-macro-api">
          <i class="fas fa-arrow-right"></i>
          Macro API
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-2-1-migration-macro-api-signature-and-return">Signature and Return</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-2-1-migration-macro-api-step-id">Step id</a>
        </li>
      
    
      <li>
        <a href="#trailblazer-2-1-migration-contract-dsl">
          <i class="fas fa-arrow-right"></i>
          Contract DSL
        </a>
      </li>
      
    
      <li>
        <a href="#trailblazer-2-1-migration-trailblazer-loader">
          <i class="fas fa-arrow-right"></i>
          Trailblazer loader
        </a>
      </li>
      
    
  </ul>
</div>

<div class="features" id="trailblazer-developer-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>Developer</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#trailblazer-developer-constant">
          <i class="fas fa-arrow-right"></i>
          Constant
        </a>
      </li>
      
    
      <li>
        <a href="#trailblazer-developer-wtf-">
          <i class="fas fa-arrow-right"></i>
          Wtf?
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-developer-wtf-exception">Exception</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-developer-wtf-activity">Activity</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-developer-wtf-color_map">color_map</a>
        </li>
      
    
      <li>
        <a href="#trailblazer-developer-render">
          <i class="fas fa-arrow-right"></i>
          Render
        </a>
      </li>
      
    
      <li>
        <a href="#trailblazer-developer-render-linear">
          <i class="fas fa-arrow-right"></i>
          Render Linear
        </a>
      </li>
      
    
      <li>
        <a href="#trailblazer-developer-client">
          <i class="fas fa-arrow-right"></i>
          Client
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-developer-client-import">Import</a>
        </li>
      
    
  </ul>
</div>

<div class="features" id="trailblazer-context-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>Context</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#trailblazer-context-ctx">
          <i class="fas fa-arrow-right"></i>
          ctx
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-context-ctx-indifferent-access">Indifferent Access</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#trailblazer-context-ctx-aliases">Aliases</a>
        </li>
      
    
  </ul>
</div>

<div class="features" id="trailblazer-option-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>Option</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#trailblazer-option-callables">
          <i class="fas fa-arrow-right"></i>
          Callables
        </a>
      </li>
      
    
  </ul>
</div>

              </div>
            </div>
          </div>
        </section>
      </main>

      <footer class="trailblazer-footer">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-3 col-lg-2">
        <a href="/2.1/index.html" class="logo-footer">Trailblazer</a>
      </div>
      <div class="col-md-6 col-lg-8">
        <nav>
          <ul class="navbar-nav documentation-nav-items">
  <li>
    <a class="nav-item nav-link active" href="/2.1/docs/trailblazer.html">
      <i class="fas fa-arrow-right"></i>
      DOCS
    </a>
  </li>

  <li>
    <a class="nav-item nav-link " href="https://dev.to/trailblazer">BLOG</a>
  </li>

  <li class="">
    <a class="nav-item nav-link " href="/2.1/about_us.html">ABOUT US</a>
  </li>

  <li>
    <a class="nav-item nav-link " href="/2.1/learn.html">LEARN</a>
  </li>

  <li class="">
    <a class="nav-item nav-link" href="/2.0/index.html">
      <i class="fas fa-arrow-right"></i>
      2.0
    </a>
  </li>

  <li>
    <a class="nav-item nav-link" href="https://trailblazer.zulipchat.com" target="_blank">
      <i class="fas fa-comments"></i>
      CHAT
    </a>
  </li>

  <!--
  
  -->
</ul>

        </nav>
      </div>
      <div class="col-md-3 col-lg-2">
        <ul class="social purple">
          <li>
            <a href="https://github.com/trailblazer" target="_blank"><i class="fab fa-github-square"></i></a>
          </li>
          <li>
            <a href="https://www.facebook.com/trailblazer.to" target="_blank"><i class="fab fa-facebook-square"></i></a>
          </li>
          <li>
            <a href="https://twitter.com/trailblazer_to" target="_blank"><i class="fab fa-twitter-square"></i></a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    </div>
  </body>
</html>
