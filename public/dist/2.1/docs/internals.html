<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

    <title>Trailblazer - Internals</title>

    
    <script src="/vite/assets/documentation.090e3fb2.js" crossorigin="anonymous" type="module"></script><link rel="modulepreload" href="/vite/assets/main.8edf4e21.js" as="script" crossorigin="anonymous">
<link rel="modulepreload" href="/vite/assets/initAnchor.90976c72.js" as="script" crossorigin="anonymous"><link rel="stylesheet" href="/vite/assets/main.663d7795.css" media="screen" />
<link rel="stylesheet" href="/vite/assets/initAnchor.22f475c1.css" media="screen" />

    <link
      href="https://fonts.googleapis.com/css?family=Raleway:200,300,400,500,600,700,800"
      rel="stylesheet"
    >
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    >
    

    
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script
        async
        src="https://www.googletagmanager.com/gtag/js?id=UA-69514939-1"
      ></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
          dataLayer.push(arguments);
        }
        gtag("js", new Date());

        gtag("config", "UA-69514939-1");
      </script>
    

    <link rel="icon" type="image/png" sizes="32x32" href="/vite/assets/favicon.39e9303e.ico">
  </head>
  <body>
    <div class="alert alert-primary m-0 rounded-0 text-center" role="alert">
      <span class="alert-text text-center">
        <!-- The new TRB 2.1 book series has begun - 82 pages are <a class="alert-link" href="https://leanpub.com/buildalib">waiting for you</a>! -->
        Dear Russian friends, please watch President Zelenskyy's
        <a href="https://twitter.com/PMoelleken/status/1496941845812760577">speech addressed to you</a>.
        🇺🇦 Help our brave mates in Ukraine
        <a
          href="https://actions.sumofus.org/a/give-to-ukrainians-who-need-an-urgent-lifeline"
        >
          with a donation
        </a>.
      </span>
    </div>

    <div class="lg-bg">
      <!-- Add class="session-show" if you need a header with dark background -->
      <header
        id="header"
        class="trailblazer-header documentation-navbar navbar navbar-expand-lg flex-column flex-md-row"
      >
        <h1 class="m-2">
          <a class="navbar-brand mr-0 mr-md-2" href="/2.1/index.html">Trailblazer</a>
        </h1>

        <div class="navbar-nav-scroll ml-md-auto">
          <ul class="navbar-nav documentation-nav-items">
  <li>
    <a class="nav-item nav-link active" href="/2.1/docs/trailblazer.html">
      <i class="fas fa-arrow-right"></i>
      DOCS
    </a>
  </li>

  <li>
    <a class="nav-item nav-link " href="https://dev.to/trailblazer">BLOG</a>
  </li>

  <li class="d-none d-md-block">
    <a class="nav-item nav-link " href="/2.1/about_us.html">ABOUT US</a>
  </li>

  <li>
    <a class="nav-item nav-link " href="/2.1/learn.html">LEARN</a>
  </li>

  <li class="d-none d-md-block">
    <a class="nav-item nav-link" href="/2.0/index.html">
      <i class="fas fa-arrow-right"></i>
      2.0
    </a>
  </li>

  <li>
    <a class="nav-item nav-link" href="https://trailblazer.zulipchat.com" target="_blank">
      <i class="fas fa-comments"></i>
      CHAT
    </a>
  </li>

  <!--
  
    <li>
      <div id="docsearch"></div> https://docsearch.algolia.com/docs/DocSearch-v3
    </li>
  
  -->
</ul>

        </div>
      </header>

      <main>
        <section class="documentation-main">
          <div class="container-fluid">
            <div class="row flex-xl-nowrap">
              <div class="col-md-3 doc-xl-2 border-bottom order-1 sidebar-accordion sidebar-scroll">
                <form class="d-md-none d-flex align-items-center position-relative py-3 mx-n3 border-bottom">
                  <button
                    class="navbar-toggler collapsed"
                    type="button"
                    data-toggle="collapse"
                    data-target="#navBarTrailBlazer"
                    aria-controls="navBarTrailBlazer"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                  >
                    <i class="far fa-lg fa-bars"></i>
                  </button>
                </form>
                <div class="collapse d-md-block py-3 mx-n3" id="navBarTrailBlazer">
                  <div class="border-bottom">
  <div class="my-4">
    <div class="sidebar-accordion-wrapper">
  <div id="trailblazer">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/trailblazer.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#trailblazer-collapse"
          aria-expanded="false"
          aria-controls="trailblazer-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Trailblazer</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="rails-integration">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/rails.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#rails-integration-collapse"
          aria-expanded="false"
          aria-controls="rails-integration-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Rails Integration</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="test">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/test.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#test-collapse"
          aria-expanded="false"
          aria-controls="test-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Test</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="internals">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/internals.html">
        <button
          class=""
          data-toggle="collapse"
          data-target="#internals-collapse"
          aria-expanded="true"
          aria-controls="internals-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Internals</span>
        </button>
      </a>
    </h2>
  </div>

  
    <div
      id="internals-collapse"
      class="collapse show"
      aria-labelledby="internals"
      data-parent="#accordion"
    >
      <ul class="nav vertical menu navbar-light">
        
          <li class="nav-item">
            <a class="nav-link active" href="#internals-dsl">
              DSL
            </a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link " href="#internals-wiring-api">
              Wiring API
            </a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link " href="#internals-activity">
              Activity
            </a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link " href="#internals-operation">
              Operation
            </a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link " href="#internals-context">
              Context
            </a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link " href="#internals-option">
              Option
            </a>
          </li>
        
      </ul>
    </div>
  
</div>

  </div>
</div>

<div class="border-bottom">
  <div class="my-4">
    <div class="sidebar-accordion-wrapper">
  <div id="activity">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/activity.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#activity-collapse"
          aria-expanded="false"
          aria-controls="activity-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Activity</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="macro">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/macro.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#macro-collapse"
          aria-expanded="false"
          aria-controls="macro-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Macro</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="operation">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/operation.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#operation-collapse"
          aria-expanded="false"
          aria-controls="operation-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Operation</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="workflow">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/workflow.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#workflow-collapse"
          aria-expanded="false"
          aria-controls="workflow-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Workflow</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="endpoint">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/endpoint.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#endpoint-collapse"
          aria-expanded="false"
          aria-controls="endpoint-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Endpoint</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

  </div>
</div>

<div class="border-bottom">
  <div class="my-4">
    <div class="sidebar-accordion-wrapper">
  <div id="reform">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/reform.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#reform-collapse"
          aria-expanded="false"
          aria-controls="reform-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Reform</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="cells">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/cells.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#cells-collapse"
          aria-expanded="false"
          aria-controls="cells-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Cells</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="representable">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/representable.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#representable-collapse"
          aria-expanded="false"
          aria-controls="representable-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Representable</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="disposable">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/disposable.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#disposable-collapse"
          aria-expanded="false"
          aria-controls="disposable-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Disposable</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="roar">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/roar.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#roar-collapse"
          aria-expanded="false"
          aria-controls="roar-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Roar</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

  </div>
</div>

<div class="border-bottom">
  <div class="my-4">
    <div class="sidebar-accordion-wrapper">
  <div id="tutorials">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/tutorials/activity.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#tutorials-collapse"
          aria-expanded="false"
          aria-controls="tutorials-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>Tutorials</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

<div class="sidebar-accordion-wrapper">
  <div id="pro">
    <h2 class="mb-0 mt-1 sidebar-accordion-item">
      <a href="/2.1/docs/pro.html">
        <button
          class="collapsed"
          data-toggle="collapse"
          data-target="#pro-collapse"
          aria-expanded="false"
          aria-controls="pro-collapse"
        >
          <i class="fas fa-chevron-right"></i>
          <i class="fas fa-times"></i>
          <span>PRO</span>
        </button>
      </a>
    </h2>
  </div>

  
</div>

  </div>
</div>

                </div>
              </div>

              <main class="col-md-9 doc-xl-8 py-md-5 pl-md-5 order-2" role="main">
                <div class="doc-block section-name session-show">
                  <h1 class="w-100">Internals</h1>
                  <ul>
                    <li>
                      <i class="far fa-clock pink"></i>
                      <span>Last updated 24 Feb 23</span>
                    </li>
                  </ul>
                </div>

                <div class="doc-block">
<p>The INTERNALS chapter is aimed at fellow developers who want to get a deeper understanding of how Trailblazer is built. If you plan to add features, improve or extend Trailblazer, this is your place to learn about details.</p>

<p>Please note that this chapter is constantly updated and extended. Are you lost? Chat to us <a href="https://trailblazer.zulipchat.com">on Zulip</a>!</p>

<p><span class="divider"></span></p>

<h2 id="internals-dsl">DSL</h2>
<p><!-- {internals-dsl-toc} --></p>

<p><a href="https://github.com/trailblazer/trailblazer-activity-dsl-linear" class="pink"><i class="fa fa-gem" aria-hidden="true"></i> trailblazer-activity-dsl-linear 1.2.0</a></p>

<p><span class="divider"></span></p>

<h3 id="internals-dsl-normalizer">Normalizer</h3>
<p><!-- {internals-dsl-normalizer-toc} --></p>

<p>TODO: FILE LAYOUT</p>

<p>A normalizer is a pipeline of steps, a bit like a simple operation without the railway. The concept of normalizers is used in a lot of places in TRB: for processing DSL options as seen with <code>#step</code> or in Reform 3’s <code>#property</code>, or even in the <code>Developer::Debugger</code>.</p>

<p>In the Activity DSL, every time <code>#step</code> is called, a normalizer is invoked and its steps eventually produce the task(s) and the wiring. The result is then added to the <a href="#sequence"><code>Sequence</code></a> instance.</p>

<p>The basic normalizer resides in <a href="https://github.com/trailblazer/trailblazer-activity-dsl-linear/blob/v1.2.0/lib/trailblazer/activity/dsl/linear/normalizer.rb"><code>trailblazer/activity/dsl/linear/normalizer.rb</code></a>. All additional normalizers for <code>#fail</code>, <code>#pass</code> and <code>#terminus</code> in both <code>Railway</code> and <code>FastTrack</code> (operation) are built on top of that normalizer.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Normalizer</li>
    <li id="internals-dsl-normalizer-extend">Extend</li>
</ul>

<p>Normalizer steps usually check for options in <code>ctx</code> and then apply logic. Suppose you want a new option <code>upcase_id: true</code> in your operation DSL that uppercase the precomputed ID.</p>

<pre><code>module MyNormalizer
  def self.upcase_id(ctx, upcase_id: nil, id:, **)
    return unless upcase_id

    ctx[:id] = id.to_s.upcase
  end
end
</code></pre>

<p>Note that this function needs <code>:id</code>, so it has to be inserted after the ID computing step. You can extend an existing normalizer using <code>Normalizer.extend!</code>.</p>

<pre><code>module Song::Activity
  class Create &lt; Trailblazer::Activity::Railway
    Trailblazer::Activity::DSL::Linear::Normalizer.extend!(
      Song::Activity::Create,
      :step
    ) do |normalizer|
      Trailblazer::Activity::DSL::Linear::Normalizer.prepend_to(
        normalizer,
        "activity.default_outputs", # few steps after "activity.normalize_id"
        {
          "my.upcase_id" =&gt; Trailblazer::Activity::DSL::Linear::Normalizer.Task(MyNormalizer.method(:upcase_id)),
        }
      )
    end

    step :create_model, upcase_id: true
    step :validate
    pass :save,         upcase_id: true # not applied!
    # ...
  end
end
</code></pre>

<p>The first argument is the activity to extend. The following arguments name the normalizers to modify. In this example, only <code>#step</code>’s normalizer will contain the <code>#upcase_id</code> step.</p>

<p>In the trace you can see, as expected, that only the ID for <code>:create_model</code> is uppercased.</p>

<p><img class="mx-auto d-block" src="/vite/assets/upcase.18002c1e.png" /></p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Normalizer</li>
    <li id="internals-dsl-normalizer-inherit">Inherit</li>
</ul>

<p>The <code>dsl</code> supports the <code>inherit: true</code> option to copy over particular recorded options from the replaced step in the superclass. This is implemented in <code>"inherit.recall_recorded_options"</code>. In order to instruct the <code>:inherit</code> logic to record and reapply certain options, you need to mark those using <code>Record()</code>.</p>

<p>If you wanted the <code>:upcase_id</code> option to be added automatically to the user’s option when using <code>inherit: true</code> the following function could be added to the above <code>MyNormalizer</code>.</p>

<pre><code>module MyNormalizer
  # ...
  def self.record_upcase_id_flag(ctx, non_symbol_options:, upcase_id: nil, **)
    ctx.merge!(
      non_symbol_options: non_symbol_options.merge(
        Trailblazer::Activity::DSL::Linear::Normalizer::Inherit.Record(
          {upcase_id: upcase_id},   # what do you want to record?
          type: :upcase_id_feature, # categorize the recorded data.
          non_symbol_options: false # this is a real :symbol option.
        )
      )
    )
  end
end
</code></pre>

<p>As <code>:upcase_id</code> is a symbol option (unlike, for example, <code>Out()</code>), the <code>:non_symbol_option</code> for <code>Record()</code> is `false.</p>

<p>It is added as another step to the original normalizer using <code>extend!</code>.</p>

<pre><code>Trailblazer::Activity::DSL::Linear::Normalizer.extend!(Song::Activity::Create, :step) do |normalizer|
  Trailblazer::Activity::DSL::Linear::Normalizer.prepend_to(
    normalizer,
    "activity.default_outputs", # step after "activity.normalize_id"
    {
      "my.upcase_id"             =&gt; Trailblazer::Activity::DSL::Linear::Normalizer.Task(MyNormalizer.method(:upcase_id)),
      "my.record_upcase_id_flag" =&gt; Trailblazer::Activity::DSL::Linear::Normalizer.Task(MyNormalizer.method(:record_upcase_id_flag)),
    }
  )
end
</code></pre>

<p><span class="divider"></span></p>

<h3 id="internals-dsl-introspect">Introspect</h3>
<p><!-- {internals-dsl-introspect-toc} --></p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Introspect</li>
    <li id="internals-dsl-introspect-data">Data</li>
</ul>

<p>The <code>#step</code> DSL allows to save arbitrary data in the activity’s <code>data</code> field.</p>

<pre><code>module Song::Activity
  class Create &lt; Trailblazer::Activity::Railway
    step :create_model,
      model_class: Song,
      DataVariable() =&gt; :model_class # mark :model_class as data-worthy.
    # ...
  end
end
</code></pre>

<p>Using <code>Introspect::Graph</code>, you can now read the <code>:model_class</code> variable from the <code>data</code> field.</p>

<pre><code>Trailblazer::Activity::Introspect.Nodes(Song::Activity::Create, id: :create_model)
  .data[:model_class] #=&gt; Song
</code></pre>

<p>This is used internally to store and expose data like <code>:extensions</code> (which is part of the Introspect API). It’s implemented in the basic normalizer in <code>"activity.compile_data"</code>.</p>

<p><span class="divider"></span></p>

<h2 id="internals-wiring-api">Wiring API</h2>
<p><!-- {internals-wiring-api-toc} --></p>

<p>As almost every task in the final activity is connected to other tasks, this wiring needs to be computed by the DSL. Two parts are required for that: the <em>outputs</em> the task exposes and the <em>connectors</em> where a particular output is connected to.</p>

<p>In order to do so, several steps such as <code>normalize_output_tuples</code> and <code>compile_connections</code> <a href="">are added</a> to the basic normalizer. The logic is implemented in <a href="https://github.com/trailblazer/trailblazer-activity-dsl-linear/blob/v1.2.0/lib/trailblazer/activity/dsl/linear/normalizer/output_tuples.rb"><code>trailblazer/activity/dsl/linear/normalizer/output_tuples.rb</code></a></p>

<p>The actual work happens in <code>#compile_wirings</code> where the connections from each output are computed from two options: <code>:outputs</code>, which represents all exposed outputs along with their signal, and <code>:output_tuples</code> associating outputs to search strategies.</p>

<p>One major design guideline is that <code>:outputs</code> is simply a list of available outputs of the step. This option does not imply any outgoing connections. Those are effectivly defined by the <code>:output_tuples</code>.</p>

<p><span class="divider"></span></p>

<h3 id="internals-wiring-api-outputs">Outputs</h3>
<p><!-- {internals-wiring-api-outputs-toc} --></p>

<p>Internally, <code>:outputs</code> can be set in two different ways. When using <code>Subprocess()</code> this option is provided by the macro, it retrieves the outputs via the activity interface from the nested task.</p>

<p>When adding a simple step (e.g. an <code>:instance_method</code>) the Strategy’s defaulting gets invoked, and only then! Again, none of the defaulting described in the following section is executed if the <code>:outputs</code> option is provided by a macro or <code>Subprocess()</code>.</p>

<p>After the outputs part is run, there will <strong>always exist</strong> an <code>:outputs</code> option for the following steps in the normalizers ctx.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Outputs</li>
    <li id="internals-wiring-api-outputs-defaulting">Defaulting</li>
</ul>

<p>There is a special outputs pipeline under <code>"activity.default_outputs"</code> which has the purpose to configure and provide <code>:outputs</code>.</p>

<p>Each Strategy subclass now adds its <code>:outputs</code> defaulting steps (e.g. <a href="https://github.com/trailblazer/trailblazer-activity-dsl-linear/blob/v1.2.0/lib/trailblazer/activity/path.rb#L16"><code>"path.outputs"</code></a> or <code>"railway.outputs"</code> to that default_outputs pipeline. Currently, the implementation is a bit confusing as we don’t have nesting in pipeline.</p>

<p>As an example, <code>Railway</code> will add <code>outputs[:failure]</code>.</p>

<pre><code>  FAILURE_OUTPUT    = {failure: Activity::Output(Activity::Left, :failure)}
  # ...
  def add_failure_output(ctx, outputs:, **)
    ctx[:outputs] = FAILURE_OUTPUT.merge(outputs)
  end
</code></pre>

<p>The <code>FastTrack</code> normalizer conditionally adds outputs, only if the respective option (e.g. <code>pass_fast: true</code> is set.</p>

<p><span class="divider"></span></p>

<h3 id="internals-wiring-api-output-tuples">Output Tuples</h3>
<p><!-- {internals-wiring-api-output-tuples-toc} --></p>

<p>Once <code>ctx[:outputs]</code> is finalized, the output tuples come into play. Using the Wiring API you can configure which output goes where.</p>

<pre><code>step :model,
  Output(:success) =&gt; Track(:ok) # THIS is the Wiring API!
</code></pre>

<p>Associating outputs to <em>connectors</em> is implemented in <code>output_tuples.rb</code>. After steps of this unit have been run, a new option <code>ctx[:output_tuples]</code> exists that connects the <code>:outputs</code> and can be transformed into <code>:connections</code>.</p>

<p>The running order for computing <code>:output_tuples</code> is as follows.</p>

<ol>
  <li>The generic <code>:inherit</code> logic from <code>"inherit.recall_recorded_options"</code> will copy over all non-generic output tuples from the superclass to <code>:non_symbol_options</code>, as if they had been provided by a user.</li>
  <li>Then, <a href="#internals-wiring-api-output-tuples-defaulting">defaulting</a> from the respective strategy takes place, where default connectors for <code>:success</code> etc are merged <em>before</em> 1.).</li>
  <li>User tuples are merged on top, potentially overwriting defaulted options, as it should be.</li>
</ol>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Output Tuples</li>
    <li id="internals-wiring-api-output-tuples-defaulting">Defaulting</li>
</ul>

<p>Each strategy provides defaulting for the case that no custom wiring is configured.
Defaulting steps such as <code>"path.step.add_success_connector"</code> <a href="https://github.com/trailblazer/trailblazer-activity-dsl-linear/blob/v1.2.0/lib/trailblazer/activity/path.rb#L25">are added before</a> <code>"output_tuples.normalize_output_tuples"</code>.</p>

<p>Alternatively, as with <code>"railway.fail.success_to_failure"</code>, a particular “inherited” connector <a href="https://github.com/trailblazer/trailblazer-activity-dsl-linear/blob/v1.2.0/lib/trailblazer/activity/railway.rb#L44">step is replaced.</a></p>

<p>This assures that the order in <code>:non_symbol_options</code> and the resulting order of <code>:output_tuples</code> is</p>

<pre><code>[&lt;default tuples&gt;, &lt;inherited tuples&gt;, &lt;user tuples&gt;]
</code></pre>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Output Tuples</li>
    <li id="internals-wiring-api-output-tuples-custom-signals">Custom signals</li>
</ul>

<p>The Wiring API allows to add outputs along with a new signal to non-nested steps.</p>

<pre><code>step :model,
  Output(Error, :error) =&gt; Track(:failure) # When Error is returned, go to failure track.
</code></pre>

<p>When using the two-argument form, a <code>Output::CustomOutput</code> tuple is created. In <code>"output_tuples.register_additional_outputs"</code> this is converted to a <code>Output::Semantic</code> after the new signal is registered as a new output on <code>:outputs</code>.</p>

<p>The conversion allows all following output tuples code to work with <code>Output::Semantic</code>, only.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Output Tuples</li>
    <li id="internals-wiring-api-output-tuples-inherit">Inherit</li>
</ul>

<p>Several steps in the normalizer supply support for <code>inherit: true</code>. It is important to understand here that only custom output tuples are inherited. The <code>:outputs</code> option is <strong>not inherited</strong>, and neither are the default output tuples.</p>

<ol>
  <li>Non-generic output tuples are marked for recording in <code>"output_tuples.remember_custom_output_tuples"</code>. These are stored via the generic inherit logic.</li>
  <li>
    <p>Currently, we assume that <code>strict_outputs = false</code>. This means we filter out custom output tuples that are not supported by the new step task or activity in <code>"output_tuples.filter_inherited_output_tuples"</code>.</p>

    <p>In order to accomplish this, the set of all inherited custom output tuples have to be explicitely computed. at present, we do that via <code>inherited_recorded_options[:custom_output_tuples]</code>.</p>
  </li>
</ol>

<p><span class="divider"></span></p>

<h3 id="internals-wiring-api-connections">Connections</h3>
<p><!-- {internals-wiring-api-connections-toc} --></p>

<p>Once the <code>:outputs</code> variable is computed, and <code>:output_tuples</code> are set, the actual connections can be compiled in <code>"activity.wirings"</code>, which is a step implemented in <code>OutputTuples::Connections.compile_wirings</code>. The returned <code>:wirings</code> array contains <code>Sequence::Search</code> instances that, during compilation, find the next step for a particular output.</p>

<p>Actually, the term <code>:wirings</code> is misleading and should be renamed to <code>:output_searches</code>.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Connections</li>
    <li id="internals-wiring-api-connections-connectors">Connectors</li>
</ul>

<p>It is also possible to build custom connectors that are able to add any number of steps (actually, sequence rows) via the ADDS interface.</p>

<p><span class="divider"></span></p>

<h3 id="internals-wiring-api-finalization">Finalization</h3>
<p><!-- {internals-wiring-api-finalization-toc} --></p>

<p>The actual <code>Sequence::Row</code> is then computed in <code>"activity.create_row"</code>. This is where <code>:wirings</code> is required. The <code>:row</code> is pushed onto <code>ctx[:adds]</code> which contains all ADDS additions for this step.</p>

<p>The <code>Row</code> instance is just one of potentially many ADDS additions that are applied to the <code>Sequence</code> instance.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Finalization</li>
    <li id="internals-wiring-api-finalization-sequence-row">Sequence Row</li>
</ul>

<!--
# ## Test structure
# wiring_api_test.rb Output(...) =>
#   inherit tests are in step_test
 -->

<p><span class="divider"></span></p>

<h3 id="internals-wiring-api-adds-interface">ADDS Interface</h3>
<p><!-- {internals-wiring-api-adds-interface-toc} --></p>

<p>The ADDS interface is implemented in the <a href="https://github.com/trailblazer/trailblazer-activity/blob/v0.15.1/lib/trailblazer/activity/adds.rb"><code>activity</code> gem</a>. It defines behavior and structures for adding rows to or altering an array or sequence.</p>

<p>It’s used for adding steps to the taskWrap pipeline, to normalizers, and to add rows representing steps to the <code>Sequence</code> in the <code>dsl</code> gem.</p>

<p>An ADDS addition instance is a hash composed like so.</p>

<pre><code>{
  row:    #&lt;Linear::Sequence::Row &gt;,
  insert: Adds::Insert.method(:Append)
}
</code></pre>

<p>A <code>Row</code> instance has to expose an <code>#id</code> method.</p>

<p>The additions are invoked using <code>Adds.apply_adds</code>.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>ADDS Interface</li>
    <li id="internals-wiring-api-adds-interface-friendly-interface">Friendly Interface</li>
</ul>

<p>The recommended way of creating ADDS additions is the “friendly interface” via <code>#adds_for</code>.</p>

<p>Assuming you had an existing pipeline creating like the one in the following snippet.</p>

<pre><code>row = Trailblazer::Activity::TaskWrap::Pipeline::Row[
  "business.task",  # id, required as per ADDS interface
  Object            # task
]

pipeline = [row] # pipe contains one item.
</code></pre>

<p>You can then use the “friendly interface” using <code>FriendlyInterface.adds_for</code> to append another element behind <code>business.task</code>.</p>

<pre><code>adds = Trailblazer::Activity::Adds::FriendlyInterface.adds_for(
  [
    [Song::Activity::Create, id: "my.create", append: "business.task"],
  ]
)
extended_pipeline = Trailblazer::Activity::Adds.apply_adds(pipeline, adds)
# =&gt; [row, #&lt;row with Song::Activity::Create&gt;]
</code></pre>

<p>Whatsoever, usually you don’t need to use the ADDS directly but through <code>TaskWrap::Extension.WrapStatic</code> or when working on <code>dsl</code>’s sequence code.</p>

<p><span class="divider"></span></p>

<h2 id="internals-activity">Activity</h2>
<p><!-- {internals-activity-toc} --></p>

<p>An <code>Activity</code> instance exposes two public methods.</p>

<ul>
  <li><code>Activity#call</code> to invoke the activity.</li>
  <li><code>Activity#to_h</code> that returns the <code>Schema</code> hash which contains all data that was collected
during compile time.</li>
</ul>

<p>This instance is usually created via a DSL, the <code>Schema</code> (and Activity) is created when compiled in <code>intermediate.rb</code>.</p>

<p>An <code>Activity</code> is created by a DSL or other layers, but it’s completely unrelated to any DSL.
It is the runtime object that actually invokes your steps.</p>

<p><span class="divider"></span></p>

<h3 id="internals-activity-schema">Schema</h3>
<p><!-- {internals-activity-schema-toc} --></p>

<p>The schema hash can be accessed using <code>Activity#to_h</code>. It consists of four mandatory keys.</p>

<ol>
  <li><code>activity.to_h[:circuit]</code> The executable `Activity::Circuit that will actually run the task graph.</li>
  <li><code>activity.to_h[:nodes]</code> A <code>Schema::Nodes</code> instance with an <code>Attributes</code> instance per activity task. Usually used with <code>Introspect::Nodes()</code>.</li>
  <li><code>activity.to_h[:outputs]</code> The output instances this activity exposes.</li>
  <li><code>activity.to_h[:config]</code> A hash keeping viable data such as <code>:wrap_static</code>. Note that you can add to this structure during compilation.</li>
</ol>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Schema</li>
    <li id="internals-activity-schema-nodes">Nodes</li>
</ul>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Schema</li>
    <li id="internals-activity-schema-attributes">Attributes</li>
</ul>

<p><span class="divider"></span></p>

<h2 id="internals-operation">Operation</h2>
<p><!-- {internals-operation-toc} --></p>

<p><a href="https://github.com/trailblazer/trailblazer-operation" class="pink"><i class="fa fa-gem" aria-hidden="true"></i> trailblazer-operation 0.10.0</a></p>

<p>The <code>trailblazer-operation</code> gem, being ridiculously tiny, provides the following features.</p>

<ol>
  <li>The <code>Trailblazer::Operation</code> class which is a <code>Trailblazer::Activity::FastTrack</code> subclass with additions.</li>
  <li>A user-friendly public <code>Operation.call</code> version implemented in <code>operation/public_call.rb</code>.</li>
  <li>The <code>ClassDependencies</code> module to set ctx variables directly on the operation class.</li>
  <li>Last but not least, <code>Operation::Result</code> that is returned from <code>Operation.call</code> and allows queries such as <code>#success?</code>.</li>
</ol>

<p>The <code>operation</code> gem is really just a syntactical sugaring on top of <code>Activity::FastTrack</code>. Everything else, from the <code>#step</code> DSL to tracing, is implemented in underlying gems.</p>

<p><span class="divider"></span></p>

<h3 id="internals-operation-public-call">Public call</h3>
<p><!-- {internals-operation-public-call-toc} --></p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>Public call</li>
    <li id="internals-operation-public-call-call_task-hack">call_task hack</li>
</ul>

<p><span class="divider"></span></p>

<h3 id="internals-operation-future">Future</h3>
<p><!-- {internals-operation-future-toc} --></p>

<p>Long-term, I’d like to remove this gem. The only useful addition is <code>Operation.call(ctx)</code>, and this comes with a <a href="">high price</a>. The <code>public_call.rb</code> code introduces unnecessary complexity and needs to apply all kinds of tricks to make <code>Operation</code> expose two different <code>#call</code> methods.</p>

<p><span class="divider"></span></p>

<h2 id="internals-context">Context</h2>
<p><!-- {internals-context-toc} --></p>

<p><a href="https://github.com/trailblazer/trailblazer-context" class="pink"><i class="fa fa-gem" aria-hidden="true"></i> trailblazer-context 0.5.1</a></p>

<p>Context aka <code>ctx</code> (or plain old <code>options</code>) is a core argument-specific data structure for Trailblazer. It provides a generic, ordered read/write interface that collects mutable runtime-computed data while providing access to any compile-time information. It is extracted into its own <a href="https://github.com/trailblazer/trailblazer-context">gem</a> and can also be used independently.</p>

<p><span class="divider"></span></p>

<h3 id="internals-context-ctx">ctx</h3>
<p><!-- {internals-context-ctx-toc} --></p>

<p><code>ctx</code> can be initialized when an operation is invoked at the run time or by defining <a href="/2.1/docs/operation.html#operation-options-class-dependencies">dependencies</a> at the compile time. Inside the operation, it gets passed down to every <code>step</code> with it’s argument position depending on step’s <a href="/2.1/docs/activity.html#activity-internals-circuit-interface">interface</a>. It will contain whatever the most recently executed step has changed and hopefully contains what you’re expecting.</p>

<div class="bd-callout bd-callout-info">
<p>If you want to see what <code>ctx</code> modifications are being performed per step or at specific steps, you can debug it using developer’s <a href="/2.1/docs/trailblazer.html#trailblazer-developer-wtf-focus_on">focus_on</a> API.</p>
</div>

<p><code>ctx</code>’s purpose is to hold the state of your activity which can also be passed down to other nested activities using <a href="/2.1/docs/activity.html#activity-wiring-api-subprocess">Subprocess</a>. You can filter what such activities can or can not “see” using <a href="/2.1/docs/activity.html#activity-variable-mapping">variable mapping</a>. After operation’s execution using public call, the <a href="/2.1/docs/operation.html#operation-overview-result">Result</a> object wraps the context for convenient access.</p>

<p>In order to provide the generic interface, scoping and debugging capabilities, the “Hash” argument you provide to an operation is initialized as an instance of <code>Trailblazer::Context::Container</code> to build up the final <code>ctx</code>. This allows us to support more features on top of it like indifferent access, aliasing etc</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>ctx</li>
    <li id="internals-context-ctx-indifferent-access">Indifferent Access</li>
</ul>

<p><code>ctx</code> mimics as “Hash” and also allows you to use Strings or Symbols interchangeably as keys; similar to the <code>params</code> hash in Rails.</p>

<pre><code>result = Memo::Create.(params: { text: "Enjoy an IPA" })

result[:params]     # =&gt; { text: "Enjoy an IPA" }
result['params']    # =&gt; { text: "Enjoy an IPA" }
</code></pre>

<p>All keys are stored as Symbols by default in order to allow them to be accessible as keyword arguments.
Note that <code>ctx</code> doesn’t provide interchangeable keys for any nested hashes because of the performance reasons.</p>

<p><span class="divider"></span></p>

<ul class="navigation">
    <li>ctx</li>
    <li id="internals-context-ctx-aliases">Aliases</li>
</ul>

<p>Most commonly found keys in <code>ctx</code> are <code>'contract.default', 'contract.default.params', 'policy.default'</code> etc. It sometimes becomes cumbersome to access them from <code>ctx</code> as they can’t be defined as keyword arguments in steps.</p>

<p>To overcome this, it is possible to define a shorter versions of context keys using <code>aliases</code>. By providing aliases mapping in <code>flow_options[:context_options]</code>, context will maintain any mutations being made on the origianl keys with 
the aliases and vice versa.</p>

<pre><code>options = { params: { text: "Enjoy an IPA" } }
flow_options = {
  context_options: {
    aliases: { 'contract.default': :contract, 'policy.default': :policy },
    container_class: Trailblazer::Context::Container::WithAliases,
  }
}

# Sorry, this feature is only reliable in Ruby &gt; 2.7
if Gem::Version.new(RUBY_VERSION) &gt;= Gem::Version.new("3.0.0")
  result = AliasesExample::Memo::Create.(options, flow_options)
else # Ruby 2.6 etc
  result = AliasesExample::Memo::Create.call_with_flow_options(options, flow_options)
end

result['contract.default']  # =&gt; Memo::Contract::Create
result[:contract]           # =&gt; Memo::Contract::Create
</code></pre>

<p><code>flow_options</code> are passed to the nested operations via <code>Subprocess</code> and all given aliases will also be applied in them by default.</p>

<pre><code>class Memo::Create &lt; Trailblazer::Operation
  # ...

  pass :sync

  def sync(ctx, contract:, **)
    # ctx['contract.default'] == ctx[:contract]
    contract.sync
  end
end
</code></pre>

<p><span class="divider"></span></p>

<h2 id="internals-option">Option</h2>
<p><!-- {internals-option-toc} --></p>

<p><a href="https://github.com/trailblazer/trailblazer-option" class="pink"><i class="fa fa-gem" aria-hidden="true"></i> trailblazer-option 0.1.2</a></p>

<p><code>Trailblazer::Option</code> is one of the core structure behind operation’s <a href="/2.1/docs/activity.html#activity-wiring-api">step API</a>, reform’s <a href="/2.1/docs/reform.html#reform-populators">populator API</a> etc. It makes us possible to accept any kind of callable objects at compile time and execute them at runtime.</p>

<pre><code class="language-ruby">class Song::Create &lt; Trailblazer::Operation
  step Authorize				# Module callable
  step :model					# Method callable
  step -&gt;(ctx, model:, **) { puts model }	# Proc callable
end
</code></pre>

<p>It is also a replacement over <a href="https://github.com/apotonick/declarative-option">declarative-option</a> and has been extracted out from <a href="https://github.com/trailblazer/trailblazer-context">trailblazer-context</a> by identifying common callable patterns.</p>

<p><span class="divider"></span></p>

<h3 id="internals-option-callables">Callables</h3>
<p><!-- {internals-option-callables-toc} --></p>

<p><code>Trailblazer::Option()</code> accepts <code>Symbol</code>, <code>lambda</code> and any other type of callable as an argument. It will be wrapped accordingly to make an executable, so you can evaluate it at runtime.</p>

<p>Passing a <code>Symbol</code> will be treated as a method that’s called on the given <code>exec_context</code>.</p>

<pre><code>option = Trailblazer::Option(:object_id)
option.(exec_context: Object.new) # =&gt; 1234567
</code></pre>

<p>Same with the objects responding to <code>.call</code> or <code>#call</code> method.</p>

<pre><code>class CallMe
  def self.call(message:, **options)
    message
  end
end

option = Trailblazer::Option(CallMe)
option.(keyword_arguments: { message: "hello!" }, exec_context: nil) # =&gt; "hello!"
</code></pre>

<div class="bd-callout bd-callout-info">
<p>Notice the usage of <code>keyword_arguments</code> while calling an <code>Option()</code>. They need to be mentioned explicitly in order for them to be <a href="https://www.ruby-lang.org/en/news/2019/12/12/separation-of-positional-and-keyword-arguments-in-ruby-3-0/">compatible</a> with ruby 2.7+.</p>
</div>

<p>And of course, passing lambdas. They get executed within given <code>exec_context</code> when set.</p>

<pre><code>option = Trailblazer::Option(-&gt; { object_id })
option.(exec_context: Object.new) # =&gt; 1234567
</code></pre>

</div>

                <aside>
                  <span class="deco-purple-cross wow fadeIn"></span>
                </aside>
              </main>

              <div class="d-none d-xl-block doc-xl-2 list-group sidebar-scroll order-3">
                <img alt="Trailblazer" class="wow fadeIn" src="/vite/assets/deco1.51110a75.webp" />
                <div class="features" id="internals-dsl-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>DSL</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#internals-dsl-normalizer">
          <i class="fas fa-arrow-right"></i>
          Normalizer
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-dsl-normalizer-extend">Extend</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#internals-dsl-normalizer-inherit">Inherit</a>
        </li>
      
    
      <li>
        <a href="#internals-dsl-introspect">
          <i class="fas fa-arrow-right"></i>
          Introspect
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-dsl-introspect-data">Data</a>
        </li>
      
    
  </ul>
</div>

<div class="features" id="internals-wiring-api-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>Wiring API</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#internals-wiring-api-outputs">
          <i class="fas fa-arrow-right"></i>
          Outputs
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-wiring-api-outputs-defaulting">Defaulting</a>
        </li>
      
    
      <li>
        <a href="#internals-wiring-api-output-tuples">
          <i class="fas fa-arrow-right"></i>
          Output Tuples
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-wiring-api-output-tuples-defaulting">Defaulting</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#internals-wiring-api-output-tuples-custom-signals">Custom signals</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#internals-wiring-api-output-tuples-inherit">Inherit</a>
        </li>
      
    
      <li>
        <a href="#internals-wiring-api-connections">
          <i class="fas fa-arrow-right"></i>
          Connections
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-wiring-api-connections-connectors">Connectors</a>
        </li>
      
    
      <li>
        <a href="#internals-wiring-api-finalization">
          <i class="fas fa-arrow-right"></i>
          Finalization
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-wiring-api-finalization-sequence-row">Sequence Row</a>
        </li>
      
    
      <li>
        <a href="#internals-wiring-api-adds-interface">
          <i class="fas fa-arrow-right"></i>
          ADDS Interface
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-wiring-api-adds-interface-friendly-interface">Friendly Interface</a>
        </li>
      
    
  </ul>
</div>

<div class="features" id="internals-activity-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>Activity</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#internals-activity-schema">
          <i class="fas fa-arrow-right"></i>
          Schema
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-activity-schema-nodes">Nodes</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#internals-activity-schema-attributes">Attributes</a>
        </li>
      
    
  </ul>
</div>

<div class="features" id="internals-operation-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>Operation</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#internals-operation-public-call">
          <i class="fas fa-arrow-right"></i>
          Public call
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-operation-public-call-call_task-hack">call_task hack</a>
        </li>
      
    
      <li>
        <a href="#internals-operation-future">
          <i class="fas fa-arrow-right"></i>
          Future
        </a>
      </li>
      
    
  </ul>
</div>

<div class="features" id="internals-context-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>Context</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#internals-context-ctx">
          <i class="fas fa-arrow-right"></i>
          ctx
        </a>
      </li>
      
        
        <li class="sub-item">
          <a href="#internals-context-ctx-indifferent-access">Indifferent Access</a>
        </li>
      
        
        <li class="sub-item">
          <a href="#internals-context-ctx-aliases">Aliases</a>
        </li>
      
    
  </ul>
</div>

<div class="features" id="internals-option-features">
  <h3>
    <i class="fas fa-times"></i>
    <span>Option</span>
  </h3>

  <ul class="vertical menu">
    
      <li>
        <a href="#internals-option-callables">
          <i class="fas fa-arrow-right"></i>
          Callables
        </a>
      </li>
      
    
  </ul>
</div>

              </div>
            </div>
          </div>
        </section>
      </main>

      <footer class="trailblazer-footer">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-3 col-lg-2">
        <a href="/2.1/index.html" class="logo-footer">Trailblazer</a>
      </div>
      <div class="col-md-6 col-lg-8">
        <nav>
          <ul class="navbar-nav documentation-nav-items">
  <li>
    <a class="nav-item nav-link active" href="/2.1/docs/trailblazer.html">
      <i class="fas fa-arrow-right"></i>
      DOCS
    </a>
  </li>

  <li>
    <a class="nav-item nav-link " href="https://dev.to/trailblazer">BLOG</a>
  </li>

  <li class="">
    <a class="nav-item nav-link " href="/2.1/about_us.html">ABOUT US</a>
  </li>

  <li>
    <a class="nav-item nav-link " href="/2.1/learn.html">LEARN</a>
  </li>

  <li class="">
    <a class="nav-item nav-link" href="/2.0/index.html">
      <i class="fas fa-arrow-right"></i>
      2.0
    </a>
  </li>

  <li>
    <a class="nav-item nav-link" href="https://trailblazer.zulipchat.com" target="_blank">
      <i class="fas fa-comments"></i>
      CHAT
    </a>
  </li>

  <!--
  
  -->
</ul>

        </nav>
      </div>
      <div class="col-md-3 col-lg-2">
        <ul class="social purple">
          <li>
            <a href="https://github.com/trailblazer" target="_blank"><i class="fab fa-github-square"></i></a>
          </li>
          <li>
            <a href="https://www.facebook.com/trailblazer.to" target="_blank"><i class="fab fa-facebook-square"></i></a>
          </li>
          <li>
            <a href="https://twitter.com/trailblazer_to" target="_blank"><i class="fab fa-twitter-square"></i></a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    </div>
  </body>
</html>
